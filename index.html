<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> <!-- ç¦æ­¢ç§»åŠ¨ç«¯ç¼©æ”¾ -->
  <title>é€®æ•å°ğŸŸ</title>
  <style>
    body {
      display: flex;
      height: 100vh;
      margin: 0;
      overflow: hidden; /* é˜²æ­¢é¡µé¢æ»šåŠ¨ */
      background: linear-gradient(135deg, #87CEFA, #4682B4); /* æ¸å˜èƒŒæ™¯ */
      position: relative;
    }

    .moving-text {
      display: inline-block;
      cursor: pointer;
      user-select: none; /* ç¦æ­¢æ–‡æœ¬é€‰æ‹© */
      position: absolute;
      font-size: 45px;
    }

    @media (max-width: 768px) {
      body {
        touch-action: manipulation;
      }
    }

    button {
      padding: 10px 20px;
      border: none;
      background-color: #3498db;
      color: white;
      font-size: 1rem;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.3s ease;
    }

    button:hover {
      background-color: #2980b9;
    }

    button:active {
      transform: scale(0.95);
    }

    .alert-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 20px;
      border-radius: 5px;
      text-align: center;
      z-index: 1000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
    }

    .alert-box h2 {
      font-size: 1rem;
      margin: 0 0 10px;
    }
    /* åŠ¨æ€æ°´æ³¢èƒŒæ™¯æ•ˆæœ */
    .background-water {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      pointer-events: none;
      z-index: -1;
    }

    .background-water::before, .background-water::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 20%, transparent 40%);
      opacity: 0.5;
      animation: water-waves 8s linear infinite;
    }

    .background-water::after {
      animation-delay: -4s;
    }

    @keyframes water-waves {
      0% {
        transform: translateY(0) translateX(0);
      }
      50% {
        transform: translateY(10%) translateX(-10%);
      }
      100% {
        transform: translateY(0) translateX(0);
      }
    }
  </style>
</head>
<body>
<div class="background-water"></div>
<span class="moving-text">ğŸŸ</span>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>

<script>
  const movingText = document.querySelector('.moving-text');
  const minMoveDistance = 100; // æœ€å°ç§»åŠ¨è·ç¦»
  let originalPosition = {x: window.innerWidth / 2, y: window.innerHeight / 2};
  let resetTimeout;
  let missCount = 0;
  let alertCount = 0;
  let isTextMovable = true;

  // è‡ªå®šä¹‰å¼¹çª—å‡½æ•°
  function showCustomAlert(message, showRestartButton = false) {
    const alertBox = document.createElement('div');
    alertBox.className = 'alert-box';

    const alertMessage = document.createElement('h2');
    alertMessage.innerText = message;
    alertBox.appendChild(alertMessage);

    if (showRestartButton) {
      const restartButton = document.createElement('button');
      restartButton.innerText = 'é‡æ–°å¼€å§‹';
      restartButton.addEventListener('click', () => {
        document.body.removeChild(alertBox);
        restartGame();
      });
      alertBox.appendChild(restartButton);
    }

    document.body.appendChild(alertBox);

    if (!showRestartButton) {
      setTimeout(() => {
        document.body.removeChild(alertBox);
      }, 2000); // 2ç§’åè‡ªåŠ¨æ¶ˆå¤±
    }
  }
  function restartGame() {
    missCount = 0;
    alertCount = 0;
    isTextMovable = true;
    resetText();
    movingText.textContent = 'ğŸŸ';
  }

  function moveText() {
    if (!isTextMovable) {
      showCustomAlert('é€®åˆ°ä½ å•¦', true);
      movingText.textContent = 'ğŸ£'
      clearTimeout(resetTimeout);
      return;
    }

    // éšæœºç”Ÿæˆæ–°çš„ä½ç½®ï¼Œç¡®ä¿æ–‡å­—ä¸ä¼šè¶…å‡ºè§†å£
    const maxX = window.innerWidth - movingText.offsetWidth;
    const maxY = window.innerHeight - movingText.offsetHeight;
    let newX, newY;

    // ç¡®ä¿ç§»åŠ¨è·ç¦»ä¸å°äº minMoveDistance
    do {
      newX = Math.random() * maxX;
    } while (Math.abs(newX - gsap.getProperty(movingText, "x")) < minMoveDistance);

    do {
      newY = Math.random() * maxY;
    } while (Math.abs(newY - gsap.getProperty(movingText, "y")) < minMoveDistance);


    gsap.to(movingText, {
      duration: 1, // åŠ¨ç”»æŒç»­æ—¶é—´
      x: newX,
      y: newY,
      ease: "power1.out" // åŠ¨ç”»ç¼“åŠ¨æ•ˆæœ
    });

    // é‡ç½®ä½ç½®çš„å®šæ—¶å™¨
    clearTimeout(resetTimeout);
    resetTimeout = setTimeout(resetText, 3000); // 1.5 ç§’åæ¢å¤åŸä½
    missCount++;
    if (missCount >= 3) {
      // resetText();
      showCustomAlert('è¿™éƒ½æŠ“ä¸ä½æˆ‘ï¼å†æ¥ä¸€æ¬¡å§ï½');
      missCount = 0; // é‡ç½®è®¡æ•°å™¨
      alertCount++;
      if (alertCount >= 3) {
        isTextMovable = false;
      }
    }
  }

  function resetText() {
    gsap.to(movingText, {
      duration: 1, // åŠ¨ç”»æŒç»­æ—¶é—´
      x: originalPosition.x - movingText.offsetWidth / 2,
      y: originalPosition.y - movingText.offsetHeight / 2,
      ease: "power1.out" // åŠ¨ç”»ç¼“åŠ¨æ•ˆæœ
    });
  }

  // ä»…åœ¨æ¡Œé¢ç«¯æ·»åŠ é¼ æ ‡äº‹ä»¶ç›‘å¬
  if (!('ontouchstart' in window)) {
    movingText.addEventListener('mouseenter', moveText);
  } else {
    // ä»…åœ¨ç§»åŠ¨ç«¯æ·»åŠ è§¦æ‘¸äº‹ä»¶ç›‘å¬
    movingText.addEventListener('touchstart', moveText);
  }

  // åˆå§‹åŒ–æ–‡å­—ä½ç½®
  gsap.set(movingText, {
    x: originalPosition.x - movingText.offsetWidth / 2,
    y: originalPosition.y - movingText.offsetHeight / 2
  });

  // çª—å£å¤§å°æ”¹å˜æ—¶ï¼Œæ›´æ–°åŸå§‹ä½ç½®å¹¶é‡ç½®æ–‡å­—ä½ç½®
  window.addEventListener('resize', () => {
    originalPosition = {x: window.innerWidth / 2, y: window.innerHeight / 2};
    resetText();
  });
</script>

</body>
</html>
